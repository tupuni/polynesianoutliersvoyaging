legend.position = "none", aspect.ratio=1) +
labs(x=paste0("PC1 (",round(eig["Dim.1","variance.percent"], digits = 1),"%)"),
y=paste0("PC2 (",round(eig["Dim.2","variance.percent"], digits = 1),"%)"))
K_12_29_PCA_2b
# PC values > distance to artefacts (individual or median of group)
# distance within all PCs > weight mean distance
dist <- data.frame(
Sample = c(d_pca[1:199,"Sample"]),
Location = c(d_pca[1:199,"Location"]),
PC1 = c(sqrt(((d_pca[200,"PC1"])-d_pca[1:199,"PC1"])^2)),
PC2 = c(sqrt(((d_pca[200,"PC2"])-d_pca[1:199,"PC2"])^2)),
PC3 = c(sqrt(((d_pca[200,"PC3"])-d_pca[1:199,"PC3"])^2)),
PC4 = c(sqrt(((d_pca[200,"PC4"])-d_pca[1:199,"PC4"])^2)),
PC5 = c(sqrt(((d_pca[200,"PC5"])-d_pca[1:199,"PC5"])^2)),
PC6 = c(sqrt(((d_pca[200,"PC6"])-d_pca[1:199,"PC6"])^2)),
PC7 = c(sqrt(((d_pca[200,"PC7"])-d_pca[1:199,"PC7"])^2)),
PC8 = c(sqrt(((d_pca[200,"PC8"])-d_pca[1:199,"PC8"])^2)),
PC9 = c(sqrt(((d_pca[200,"PC9"])-d_pca[1:199,"PC9"])^2)),
PC10 = c(sqrt(((d_pca[200,"PC10"])-d_pca[1:199,"PC10"])^2)),
PC11 = c(sqrt(((d_pca[200,"PC11"])-d_pca[1:199,"PC11"])^2)),
PC12 = c(sqrt(((d_pca[200,"PC12"])-d_pca[1:199,"PC12"])^2)),
PC13 = c(sqrt(((d_pca[200,"PC13"])-d_pca[1:199,"PC13"])^2)),
PC14 = c(sqrt(((d_pca[200,"PC14"])-d_pca[1:199,"PC14"])^2)),
PC15 = c(sqrt(((d_pca[200,"PC15"])-d_pca[1:199,"PC15"])^2)),
PC16 = c(sqrt(((d_pca[200,"PC16"])-d_pca[1:199,"PC16"])^2)),
PC17 = c(sqrt(((d_pca[200,"PC17"])-d_pca[1:199,"PC17"])^2)),
PC18 = c(sqrt(((d_pca[200,"PC18"])-d_pca[1:199,"PC18"])^2)),
PC19 = c(sqrt(((d_pca[200,"PC19"])-d_pca[1:199,"PC19"])^2))) %>%
mutate(weight_mean = (
(PC1*eig[1,2])+(PC2*eig[2,2])+(PC3*eig[3,2])+(PC4*eig[4,2])+(PC5*eig[5,2])+
(PC6*eig[6,2])+(PC7*eig[7,2])+(PC8*eig[8,2])+(PC9*eig[9,2])+
(PC10*eig[10,2])+(PC11*eig[11,2])+(PC12*eig[12,2])+(PC13*eig[13,2])+
(PC14*eig[14,2])+(PC15*eig[15,2])+(PC16*eig[16,2])+(PC17*eig[17,2])+
(PC18*eig[18,2])+(PC19*eig[19,2])) / (sum(eig[1:19,2])))
# distances > distance index, from 1 (closer to artefact) to 5 (more distant)
# 1= min > middle point between Min and 1st quartile
# 2= middle point between Min and 1st quartile > 1st quartile
# 3= 1st quartile > median
# 4= median > 3rd quartile
# 5= 3rd quartile > max
summary_stat <- data.frame(unclass(summary(dist$weight_mean)), check.names = F)
dist <- dist %>% mutate(
dist_cat = cut(
weight_mean,
breaks=c(0,
(summary_stat["1st Qu.",]-((summary_stat["1st Qu.",]-summary_stat["Min.",])/2)),
summary_stat["1st Qu.",],
summary_stat["Median",],
summary_stat["3rd Qu.",],
summary_stat["Max.",]),
labels=c('1','2','3','4','5')))
distance_index <- ggplot(dist, aes(x = factor(dist_cat), fill=Location)) +
geom_bar(position="fill", alpha=.75) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
theme_void() + theme(
axis.title.x=element_text(size=9, vjust = -1.5),
axis.text.x=element_text(size=8, vjust = -.5),
axis.title.y=element_blank(),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.1,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("Distance index","\n","(Total variance)"))
# PC values > distance to artefacts (individual or median of group)
# distance within all PCs > weight mean distance
dist <- data.frame(
Sample = c(d_pca[1:199,"Sample"]),
Location = c(d_pca[1:199,"Location"]),
PC1 = c(sqrt(((d_pca[200,"PC1"])-d_pca[1:199,"PC1"])^2)),
PC2 = c(sqrt(((d_pca[200,"PC2"])-d_pca[1:199,"PC2"])^2)),
PC3 = c(sqrt(((d_pca[200,"PC3"])-d_pca[1:199,"PC3"])^2)),
PC4 = c(sqrt(((d_pca[200,"PC4"])-d_pca[1:199,"PC4"])^2)),
PC5 = c(sqrt(((d_pca[200,"PC5"])-d_pca[1:199,"PC5"])^2)),
PC6 = c(sqrt(((d_pca[200,"PC6"])-d_pca[1:199,"PC6"])^2)),
PC7 = c(sqrt(((d_pca[200,"PC7"])-d_pca[1:199,"PC7"])^2)),
PC8 = c(sqrt(((d_pca[200,"PC8"])-d_pca[1:199,"PC8"])^2)),
PC9 = c(sqrt(((d_pca[200,"PC9"])-d_pca[1:199,"PC9"])^2)),
PC10 = c(sqrt(((d_pca[200,"PC10"])-d_pca[1:199,"PC10"])^2)),
PC11 = c(sqrt(((d_pca[200,"PC11"])-d_pca[1:199,"PC11"])^2)),
PC12 = c(sqrt(((d_pca[200,"PC12"])-d_pca[1:199,"PC12"])^2)),
PC13 = c(sqrt(((d_pca[200,"PC13"])-d_pca[1:199,"PC13"])^2)),
PC14 = c(sqrt(((d_pca[200,"PC14"])-d_pca[1:199,"PC14"])^2)),
PC15 = c(sqrt(((d_pca[200,"PC15"])-d_pca[1:199,"PC15"])^2)),
PC16 = c(sqrt(((d_pca[200,"PC16"])-d_pca[1:199,"PC16"])^2)),
PC17 = c(sqrt(((d_pca[200,"PC17"])-d_pca[1:199,"PC17"])^2)),
PC18 = c(sqrt(((d_pca[200,"PC18"])-d_pca[1:199,"PC18"])^2)),
PC19 = c(sqrt(((d_pca[200,"PC19"])-d_pca[1:199,"PC19"])^2))) %>%
mutate(weight_mean = (
(PC1*eig[1,2])+(PC2*eig[2,2])+(PC3*eig[3,2])+(PC4*eig[4,2])+(PC5*eig[5,2])+
(PC6*eig[6,2])+(PC7*eig[7,2])+(PC8*eig[8,2])+(PC9*eig[9,2])+
(PC10*eig[10,2])+(PC11*eig[11,2])+(PC12*eig[12,2])+(PC13*eig[13,2])+
(PC14*eig[14,2])+(PC15*eig[15,2])+(PC16*eig[16,2])+(PC17*eig[17,2])+
(PC18*eig[18,2])+(PC19*eig[19,2])) / (sum(eig[1:19,2])))
# distances > distance index, from 1 (closer to artefact) to 5 (more distant)
# 1= min > middle point between Min and 1st quartile
# 2= middle point between Min and 1st quartile > 1st quartile
# 3= 1st quartile > median
# 4= median > 3rd quartile
# 5= 3rd quartile > max
summary_stat <- data.frame(unclass(summary(dist$weight_mean)), check.names = F)
dist <- dist %>% mutate(
dist_cat = cut(
weight_mean,
breaks=c(0,
(summary_stat["1st Qu.",]-((summary_stat["1st Qu.",]-summary_stat["Min.",])/2)),
summary_stat["1st Qu.",],
summary_stat["Median",],
summary_stat["3rd Qu.",],
summary_stat["Max.",]),
labels=c('1','2','3','4','5')))
# distances > distance index, from 1 (closer to artefact) to 5 (more distant)
# 1= min > middle point between Min and 1st quartile
# 2= middle point between Min and 1st quartile > 1st quartile
# 3= 1st quartile > median
# 4= median > 3rd quartile
# 5= 3rd quartile > max
summary_stat <- data.frame(unclass(summary(dist$weight_mean)), check.names = F)
View(summary_stat)
# PC values > distance to artefacts (individual or median of group)
# distance within all PCs > weight mean distance
dist <- data.frame(
Sample = c(d_pca[1:173,"Sample"]),
Location = c(d_pca[1:173,"Location"]),
PC1 = c(sqrt(((d_pca[174,"PC1"])-d_pca[1:173,"PC1"])^2)),
PC2 = c(sqrt(((d_pca[174,"PC2"])-d_pca[1:173,"PC2"])^2)),
PC3 = c(sqrt(((d_pca[174,"PC3"])-d_pca[1:173,"PC3"])^2)),
PC4 = c(sqrt(((d_pca[174,"PC4"])-d_pca[1:173,"PC4"])^2)),
PC5 = c(sqrt(((d_pca[174,"PC5"])-d_pca[1:173,"PC5"])^2)),
PC6 = c(sqrt(((d_pca[174,"PC6"])-d_pca[1:173,"PC6"])^2)),
PC7 = c(sqrt(((d_pca[174,"PC7"])-d_pca[1:173,"PC7"])^2)),
PC8 = c(sqrt(((d_pca[174,"PC8"])-d_pca[1:173,"PC8"])^2)),
PC9 = c(sqrt(((d_pca[174,"PC9"])-d_pca[1:173,"PC9"])^2)),
PC10 = c(sqrt(((d_pca[174,"PC10"])-d_pca[1:173,"PC10"])^2)),
PC11 = c(sqrt(((d_pca[174,"PC11"])-d_pca[1:173,"PC11"])^2)),
PC12 = c(sqrt(((d_pca[174,"PC12"])-d_pca[1:173,"PC12"])^2)),
PC13 = c(sqrt(((d_pca[174,"PC13"])-d_pca[1:173,"PC13"])^2)),
PC14 = c(sqrt(((d_pca[174,"PC14"])-d_pca[1:173,"PC14"])^2)),
PC15 = c(sqrt(((d_pca[174,"PC15"])-d_pca[1:173,"PC15"])^2)),
PC16 = c(sqrt(((d_pca[174,"PC16"])-d_pca[1:173,"PC16"])^2)),
PC17 = c(sqrt(((d_pca[174,"PC17"])-d_pca[1:173,"PC17"])^2)),
PC18 = c(sqrt(((d_pca[174,"PC18"])-d_pca[1:173,"PC18"])^2)),
PC19 = c(sqrt(((d_pca[174,"PC19"])-d_pca[1:173,"PC19"])^2))) %>%
mutate(weight_mean = (
(PC1*eig[1,2])+(PC2*eig[2,2])+(PC3*eig[3,2])+(PC4*eig[4,2])+(PC5*eig[5,2])+
(PC6*eig[6,2])+(PC7*eig[7,2])+(PC8*eig[8,2])+(PC9*eig[9,2])+
(PC10*eig[10,2])+(PC11*eig[11,2])+(PC12*eig[12,2])+(PC13*eig[13,2])+
(PC14*eig[14,2])+(PC15*eig[15,2])+(PC16*eig[16,2])+(PC17*eig[17,2])+
(PC18*eig[18,2])+(PC19*eig[19,2])) / (sum(eig[1:19,2])))
# distances > distance index, from 1 (closer to artefact) to 5 (more distant)
# 1= min > middle point between Min and 1st quartile
# 2= middle point between Min and 1st quartile > 1st quartile
# 3= 1st quartile > median
# 4= median > 3rd quartile
# 5= 3rd quartile > max
summary_stat <- data.frame(unclass(summary(dist$weight_mean)), check.names = F)
dist <- dist %>% mutate(
dist_cat = cut(
weight_mean,
breaks=c(0,
(summary_stat["1st Qu.",]-((summary_stat["1st Qu.",]-summary_stat["Min.",])/2)),
summary_stat["1st Qu.",],
summary_stat["Median",],
summary_stat["3rd Qu.",],
summary_stat["Max.",]),
labels=c('1','2','3','4','5')))
distance_index <- ggplot(dist, aes(x = factor(dist_cat), fill=Location)) +
geom_bar(position="fill", alpha=.75) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
theme_void() + theme(
axis.title.x=element_text(size=9, vjust = -1.5),
axis.text.x=element_text(size=8, vjust = -.5),
axis.title.y=element_blank(),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.1,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("Distance index","\n","(Total variance)"))
distance_index
distance_index <- distance_index/plot_spacer() + plot_layout(heights = c(4,.1))
pdf(here("analysis","figures","Figure_3","Fig3-h.pdf"), width=5.5, height=3.5)
(K_12_29_PCA_2b | distance_index) + plot_layout(widths = c(4, 2))
dev.off()
(K_12_29_PCA_2b | distance_index) + plot_layout(widths = c(4, 2))
pdf(here("analysis","figures","Figure_3","Fig3-h.pdf"), width=5.5, height=3.5)
(K_12_29_PCA_2b | distance_index) + plot_layout(widths = c(4, 2))
dev.off()
shapes <- c("Luzon Arc"=21,"Sulawesi Arc"=22,"Sunda Arc"=23,"Banda Arc"=24,
"Yap Arc"=25,"Mariana Arc"=21,"Bismarck Arc"=22,"Solomon Arc"=23,
"Vanuatu Arc"=24,"Tonga-Fiji"=25,"New Zealand"=21,
"E-11-03"=0,"E-11-06"=1,"E-11-07"=8,"E-11-10"=0,"E-11-11"=1,
"E-11-13"=2,"E-11-16"=5,"E-11-18"=6,"E-11-19"=8,"K-12-28"=3,"K-12-29"=4)
cols <- c("Luzon Arc"="#440154","Sulawesi Arc"="#345E8C","Sunda Arc"="#404386",
"Banda Arc"="#472374","Yap Arc"="#29778E","Mariana Arc"="#218F8B",
"Bismarck Arc"="#25A782","Solomon Arc"="#44BE6F","Vanuatu Arc"="#7AD04F",
"Tonga-Fiji"="#BADD26","New Zealand"="#FDE725",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
contour <- c("Luzon Arc"="black","Sulawesi Arc"="black","Sunda Arc"="black",
"Banda Arc"="black","Yap Arc"="black","Mariana Arc"="black",
"Bismarck Arc"="black","Solomon Arc"="black","Vanuatu Arc"="black",
"Tonga-Fiji"="black","New Zealand"="black",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
#### Fig S12d ####
IAB <- q9
s <- joined_data %>% dplyr::filter(Sample %in% c(
"E-11-10","E-11-11","E-11-13","E-11-16","E-11-18","K-12-29")) %>%
mutate(Location = case_when(
grepl("E-11-10", Sample) ~ "Vanuatu Arc",
grepl("E-11-11", Sample) ~ "Vanuatu Arc",
grepl("E-11-13", Sample) ~ "Vanuatu Arc",
grepl("E-11-16", Sample) ~ "Vanuatu Arc",
grepl("E-11-18", Sample) ~ "Vanuatu Arc",
grepl("K-12-29", Sample) ~ "K-12-29")) %>%
dplyr::select(Sample,Location,lat,long,SiO2,TiO2,Al2O3,MnO,MgO,CaO,Na2O,K2O,
Li,Sc,Ti,V,Cr,Co,Ni,Cu,Zn,As,Rb,Sr,Y,Zr,Nb,Cd,Cs,Ba,La,Ce,Pr,Nd,
Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,Pb,Th,U,K,
Sr87_Sr86,Nd143_Nd144,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204)
IAB <- full_join(IAB,s[1:5,])
s <- s[6,]
p7 <- IAB %>%
ggplot(aes(x=Rb,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,60)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1) +
labs(x="Rb (ppm)")
p8 <- IAB %>%
ggplot(aes(x=Sr,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,1200)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.title.y = element_blank(),
axis.ticks.y = element_blank(), legend.position = "none", aspect.ratio=1) +
labs(x="Sr (ppm)")
p9 <- IAB %>%
ggplot(aes(x=Zr,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,150)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.title.y = element_blank(),
axis.ticks.y = element_blank(), legend.position = "none", aspect.ratio=1) +
labs(x="Zr (ppm)")
S12d <- p7|p8|p9
S12d
require(here)
require(tidyverse)
require(RSQLite)
require(patchwork)
georoc <- dbConnect(RSQLite::SQLite(), path_to_georoc)
pofatu <- dbConnect(RSQLite::SQLite(), path_to_pofatu)
shapes <- c("Luzon Arc"=21,"Sulawesi Arc"=22,"Sunda Arc"=23,"Banda Arc"=24,
"Yap Arc"=25,"Mariana Arc"=21,"Bismarck Arc"=22,"Solomon Arc"=23,
"Vanuatu Arc"=24,"Tonga-Fiji"=25,"New Zealand"=21,
"E-11-03"=0,"E-11-06"=1,"E-11-07"=8,"E-11-10"=0,"E-11-11"=1,
"E-11-13"=2,"E-11-16"=5,"E-11-18"=6,"E-11-19"=8,"K-12-28"=3,"K-12-29"=4)
cols <- c("Luzon Arc"="#440154","Sulawesi Arc"="#345E8C","Sunda Arc"="#404386",
"Banda Arc"="#472374","Yap Arc"="#29778E","Mariana Arc"="#218F8B",
"Bismarck Arc"="#25A782","Solomon Arc"="#44BE6F","Vanuatu Arc"="#7AD04F",
"Tonga-Fiji"="#BADD26","New Zealand"="#FDE725",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
contour <- c("Luzon Arc"="black","Sulawesi Arc"="black","Sunda Arc"="black",
"Banda Arc"="black","Yap Arc"="black","Mariana Arc"="black",
"Bismarck Arc"="black","Solomon Arc"="black","Vanuatu Arc"="black",
"Tonga-Fiji"="black","New Zealand"="black",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
#### Fig S12a ####
IAB <- full_join(q2,q3)
s <- joined_data %>%
filter(Sample %in% c("E-11-03")) %>%
mutate(Location = case_when(grepl("E-11-03", Sample) ~ "E-11-03"))
p1 <- IAB %>%
ggplot(aes(x=Rb,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
#scale_x_continuous(limits=c(0,.35)) +
scale_y_continuous(limits=c(0,12)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.title.x = element_blank(),
axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1)
p2 <- IAB %>%
ggplot(aes(x=Sr,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
#scale_x_continuous(limits=c(0,.35)) +
scale_y_continuous(limits=c(0,12)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
p3 <- IAB %>%
ggplot(aes(x=Zr,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(80,350)) +
scale_y_continuous(limits=c(0,12)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
S12a <- p1|p2|p3
S12a
#### Fig S12b ####
IAB <- q5
s <- joined_data %>% dplyr::filter(Sample %in% c(
"E-11-10","E-11-11","E-11-13","E-11-16","E-11-18","E-11-06","E-11-07")) %>%
mutate(Location = case_when(
grepl("E-11-10", Sample) ~ "Vanuatu Arc",
grepl("E-11-11", Sample) ~ "Vanuatu Arc",
grepl("E-11-13", Sample) ~ "Vanuatu Arc",
grepl("E-11-16", Sample) ~ "Vanuatu Arc",
grepl("E-11-18", Sample) ~ "Vanuatu Arc",
grepl("E-11-06", Sample) ~ "E-11-06",
grepl("E-11-07", Sample) ~ "E-11-07")) %>%
dplyr::select(Sample,Location,lat,long,SiO2,TiO2,Al2O3,MnO,MgO,CaO,Na2O,K2O,
Li,Sc,Ti,V,Cr,Co,Ni,Cu,Zn,As,Rb,Sr,Y,Zr,Nb,Cd,Cs,Ba,La,Ce,Pr,Nd,
Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,Pb,Th,U,K,
Sr87_Sr86,Nd143_Nd144,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204)
IAB <- full_join(IAB,s[3:7,])
s <- s[1:2,]
p4 <- IAB %>%
ggplot(aes(x=Rb,y=Ba/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,55)) + scale_y_continuous(limits=c(0,400)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.title.x = element_blank(),
axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1)
p5 <- IAB %>%
ggplot(aes(x=Sr,y=Ba/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,1500)) + scale_y_continuous(limits=c(0,400)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
p6 <- IAB %>%
ggplot(aes(x=Zr,y=Ba/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) + geom_point(data=s, size=3) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,150)) + scale_y_continuous(limits=c(0,400)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
S12b <- p4|p5|p6
S12b
#### Fig S12c ####
IAB <- q7
s <- joined_data %>% dplyr::filter(Sample %in% c("K-12-28")) %>%
mutate(Location = case_when(grepl("K-12-28", Sample) ~ "K-12-28"))
p7 <- IAB %>%
ggplot(aes(x=Rb,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Bismarck Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,45)) + scale_y_continuous(limits=c(0,.8)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.title.x = element_blank(),
axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1)
p8 <- IAB %>%
ggplot(aes(x=Sr,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Bismarck Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,1000)) + scale_y_continuous(limits=c(0,.8)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
p9 <- IAB %>%
ggplot(aes(x=Zr,y=U/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Bismarck Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,150)) + scale_y_continuous(limits=c(0,.8)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_blank(), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position = "none", aspect.ratio=1)
S12c <- p7|p8|p9
S12c
#### Fig S12d ####
IAB <- q9
s <- joined_data %>% dplyr::filter(Sample %in% c(
"E-11-10","E-11-11","E-11-13","E-11-16","E-11-18","K-12-29")) %>%
mutate(Location = case_when(
grepl("E-11-10", Sample) ~ "Vanuatu Arc",
grepl("E-11-11", Sample) ~ "Vanuatu Arc",
grepl("E-11-13", Sample) ~ "Vanuatu Arc",
grepl("E-11-16", Sample) ~ "Vanuatu Arc",
grepl("E-11-18", Sample) ~ "Vanuatu Arc",
grepl("K-12-29", Sample) ~ "K-12-29")) %>%
dplyr::select(Sample,Location,lat,long,SiO2,TiO2,Al2O3,MnO,MgO,CaO,Na2O,K2O,
Li,Sc,Ti,V,Cr,Co,Ni,Cu,Zn,As,Rb,Sr,Y,Zr,Nb,Cd,Cs,Ba,La,Ce,Pr,Nd,
Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,Pb,Th,U,K,
Sr87_Sr86,Nd143_Nd144,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204)
IAB <- full_join(IAB,s[1:5,])
s <- s[6,]
p7 <- IAB %>%
ggplot(aes(x=Rb,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,60)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1) +
labs(x="Rb (ppm)")
p8 <- IAB %>%
ggplot(aes(x=Sr,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,1200)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.title.y = element_blank(),
axis.ticks.y = element_blank(), legend.position = "none", aspect.ratio=1) +
labs(x="Sr (ppm)")
p9 <- IAB %>%
ggplot(aes(x=Zr,y=Th/Yb, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_point(size=3, stroke=.25) +
geom_point(data=subset(IAB, Location %in% c("Vanuatu Arc")), size=3, stroke=.25) +
geom_point(data=s, size=3) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(0,150)) + scale_y_continuous(limits=c(0,3)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 14), axis.text = element_text(size = 8),
axis.text.y = element_blank(), axis.title.y = element_blank(),
axis.ticks.y = element_blank(), legend.position = "none", aspect.ratio=1) +
labs(x="Zr (ppm)")
S12d <- p7|p8|p9
S12d
pdf(here("analysis","supplementary-materials","FigS12.pdf"), width=8, height=10)
S12a/S12b/S12c/S12d
dev.off()
source("~/Documents/Github/polynesianoutliersvoyaging/analysis/sql-queries.R")

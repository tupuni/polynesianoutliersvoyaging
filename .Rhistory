res.pca.df <- cbind(OIB[,1:2], (as.data.frame(res.pca$x)))
pred <- stats::predict(res.pca, s[,3:7])
pred <- cbind(s[,1:2], pred)
d_pca <- full_join(res.pca.df, pred)
E_T_PCA_1b <- d_pca %>%
ggplot(aes(x=PC1,y=PC2, shape=factor(Location), fill=factor(Location),
color=factor(Location), group=Sample)) +
geom_vline(aes(xintercept = 0), size=.25, linetype="dashed") +
geom_hline(aes(yintercept = 0), size=.25, linetype="dashed") +
geom_point(size = 3, stroke=.25) + scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) + scale_color_manual(values=contour) +
scale_x_continuous(limits=c(-4, 2.5)) + scale_y_continuous(limits=c(-2.5, 2.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 9), axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1) +
labs(x=paste0("PC1 (",round(eig["Dim.1","variance.percent"], digits = 1),"%)"),
y=paste0("PC2 (",round(eig["Dim.2","variance.percent"], digits = 1),"%)"))
## PCs
PC1 <- ggplot(d_pca, aes(x = PC1, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[28:33,"PC1"], xend=d_pca[28:33,"PC1"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC1 (",round(eig["Dim.1","variance.percent"], digits = 1),"%)"))
PC2 <- ggplot(d_pca, aes(x = PC2, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[28:33,"PC2"], xend=d_pca[28:33,"PC2"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC2 (",round(eig["Dim.2","variance.percent"], digits = 1),"%)"))
PC3 <- ggplot(d_pca, aes(x = PC3, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[28:33,"PC3"], xend=d_pca[28:33,"PC3"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC3 (",round(eig["Dim.3","variance.percent"], digits = 1),"%)"))
PC4 <- ggplot(d_pca, aes(x = PC4, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[28:33,"PC4"], xend=d_pca[28:33,"PC4"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC4 (",round(eig["Dim.4","variance.percent"], digits = 1),"%)"))
PCs <- PC1/PC2/PC3/PC4 & theme(plot.margin = unit(c(5,0,5,0), "pt"))
pdf(here("analysis","figures","Figure_4","Fig4-a.pdf"), width=6, height=3.5)
E_T_PCA_1b | PCs
dev.off()
View(d_pca)
View(d_pca)
## PCs
PC1 <- ggplot(d_pca, aes(x = PC1, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[67:74,"PC1"], xend=d_pca[67:74,"PC1"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC1 (",round(eig["Dim.1","variance.percent"], digits = 1),"%)"))
PC2 <- ggplot(d_pca, aes(x = PC2, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[67:74,"PC2"], xend=d_pca[67:74,"PC2"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC2 (",round(eig["Dim.2","variance.percent"], digits = 1),"%)"))
PC3 <- ggplot(d_pca, aes(x = PC3, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[67:74,"PC3"], xend=d_pca[67:74,"PC3"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC3 (",round(eig["Dim.3","variance.percent"], digits = 1),"%)"))
PC4 <- ggplot(d_pca, aes(x = PC4, y = 0)) +
geom_density_ridges(aes(color=Location, fill=Location), alpha=0.4, size=.25) +
annotate("segment", x=d_pca[67:74,"PC4"], xend=d_pca[67:74,"PC4"],
y=0, yend=Inf, col="red", size=.75) + # E-11-03
scale_color_manual(values = cols) + scale_fill_manual(values = cols) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_void() + theme(
axis.text.x=element_text(size=6), axis.title.x=element_text(size=6),
axis.line.x=element_line(size=.25), axis.ticks.length.x=unit(.05,"cm"),
axis.ticks.x=element_line(size=.25, color="black"), legend.position="none") +
labs(x=paste0("PC4 (",round(eig["Dim.4","variance.percent"], digits = 1),"%)"))
PCs <- PC1/PC2/PC3/PC4 & theme(plot.margin = unit(c(5,0,5,0), "pt"))
pdf(here("analysis","figures","Figure_4","Fig4-a.pdf"), width=6, height=3.5)
E_T_PCA_1b | PCs
dev.off()
Emae_Taumako[2:29] %>% round(digits=2)
joined_data_ranges[4,2:3]
joined_data_ranges[4,]
joined_data_ranges[11:15,2:30]
joined_data_ranges[11:15,2:34]
joined_data_ranges[11:15,2:35]
joined_data_ranges[11:15,2:36]
joined_data_ranges[4,2:35]
joined_data_ranges[11:15,2:35]
q11 <- dbGetQuery(georoc,
"SELECT *
FROM 'sample'
WHERE LAND_OR_SEA='SAE' AND ROCK_TYPE='VOL' AND
TECTONIC_SETTING='OCEAN ISLAND' AND
((`SIO2(WT%)` > 45.2 AND `SIO2(WT%)` < 48.2 AND
`NA2O(WT%)` > 2.08 AND `NA2O(WT%)` < 5.08 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.9 AND
`RB(PPM)` > 18.3 AND `RB(PPM)` < 54.9 AND
`BA(PPM)` > 160 AND `BA(PPM)` < 480 AND
`TH(PPM)` > 1.95 AND `TH(PPM)` < 5.84 AND
`SR(PPM)` > 352 AND `SR(PPM)` < 1056 AND
`NB(PPM)` > 24.8 AND `NB(PPM)` < 74.5) OR
(`SIO2(WT%)` > 44.3 AND `SIO2(WT%)` < 47.3 AND
`NA2O(WT%)` > 2 AND `NA2O(WT%)` < 5 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.82 AND
`RB(PPM)` > 16.8 AND `RB(PPM)` < 50.4 AND
`BA(PPM)` > 137 AND `BA(PPM)` < 413 AND
`TH(PPM)` > 1.86 AND `TH(PPM)` < 5.60 AND
`SR(PPM)` > 332 AND `SR(PPM)` < 996 AND
`NB(PPM)` > 24.7 AND `NB(PPM)` < 74.1) OR
(`SIO2(WT%)` > 43.5 AND `SIO2(WT%)` < 46.5 AND
`NA2O(WT%)` > 1.9 AND `NA2O(WT%)` < 4.9 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.78 AND
`RB(PPM)` > 15.3 AND `RB(PPM)` < 46.05 AND
`BA(PPM)` > 126 AND `BA(PPM)` < 378 AND
`TH(PPM)` > 1.58 AND `TH(PPM)` < 4.74 AND
`SR(PPM)` > 294 AND `SR(PPM)` < 882 AND
`NB(PPM)` > 21 AND `NB(PPM)` < 63.1) OR
(`SIO2(WT%)` > 45.9 AND `SIO2(WT%)` < 48.9 AND
`NA2O(WT%)` > 2.18 AND `NA2O(WT%)` < 5.18 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.99 AND
`RB(PPM)` > 20.55 AND `RB(PPM)` < 61.65 AND
`BA(PPM)` > 162 AND `BA(PPM)` < 488 AND
`TH(PPM)` > 2.13 AND `TH(PPM)` < 6.39 AND
`SR(PPM)` > 365 AND `SR(PPM)` < 1095 AND
`NB(PPM)` > 24.3 AND `NB(PPM)` < 72.9) OR
(`SIO2(WT%)` > 44.1 AND `SIO2(WT%)` < 47.1 AND
`NA2O(WT%)` > 1.8 AND `NA2O(WT%)` < 4.8 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.72 AND
`RB(PPM)` > 15.6 AND `RB(PPM)` < 47 AND
`BA(PPM)` > 128 AND `BA(PPM)` < 385 AND
`TH(PPM)` > 1.58 AND `TH(PPM)` < 4.74 AND
`SR(PPM)` > 296 AND `SR(PPM)` < 890 AND
`NB(PPM)` > 20.4 AND `NB(PPM)` < 61.2) OR
(`SIO2(WT%)` > 45.7 AND `SIO2(WT%)` < 48.7 AND
`NA2O(WT%)` > 2.08 AND `NA2O(WT%)` < 5.08 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.85 AND
`RB(PPM)` > 18.2 AND `RB(PPM)` < 54.6 AND
`BA(PPM)` > 143 AND `BA(PPM)` < 431 AND
`TH(PPM)` > 1.84 AND `TH(PPM)` < 5.52 AND
`SR(PPM)` > 370 AND `SR(PPM)` < 1110 AND
`NB(PPM)` > 23.5 AND `NB(PPM)` < 70.5) OR
(`SIO2(WT%)` > 37 AND `SIO2(WT%)` < 40 AND
`NA2O(WT%)` > 1.61 AND `NA2O(WT%)` < 4.61 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.91 AND
`RB(PPM)` > 12.2 AND `RB(PPM)` < 36.8 AND
`BA(PPM)` > 244 AND `BA(PPM)` < 734 AND
`TH(PPM)` > 2.73 AND `TH(PPM)` < 8.2 AND
`SR(PPM)` > 452 AND `SR(PPM)` < 1358 AND
`NB(PPM)` > 46.4 AND `NB(PPM)` < 139.3) OR
(`SIO2(WT%)` > 43.1 AND `SIO2(WT%)` < 46.1 AND
`NA2O(WT%)` > 0.89 AND `NA2O(WT%)` < 3.89 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 1.89 AND
`RB(PPM)` > 2.77 AND `RB(PPM)` < 8.32 AND
`BA(PPM)` > 59 AND `BA(PPM)` < 177 AND
`TH(PPM)` > 0.56 AND `TH(PPM)` < 1.67 AND
`SR(PPM)` > 191 AND `SR(PPM)` < 573 AND
`NB(PPM)` > 6.45 AND `NB(PPM)` < 19.35) OR
(`SIO2(WT%)` > 42.9 AND `SIO2(WT%)` < 45.9 AND
`NA2O(WT%)` > 2.41 AND `NA2O(WT%)` < 5.41 AND
`K2O(WT%)` > 0 AND `K2O(WT%)` < 2.35 AND
`RB(PPM)` > 1.21 AND `RB(PPM)` < 3.64 AND
`BA(PPM)` > 15.75 AND `BA(PPM)` < 47.3 AND
`TH(PPM)` > 1.02 AND `TH(PPM)` < 3.06 AND
`SR(PPM)` > 331 AND `SR(PPM)` < 995 AND
`NB(PPM)` > 22.2 AND `NB(PPM)` < 66.6))") %>%
get_georoc_location() %>% filter(Location != "na") %>% rename_georoc() %>%
Ti_from_TiO2() %>% K_from_K2O() %>% dplyr::select(
Sample,Location,lat,long,SiO2,TiO2,Al2O3,MnO,MgO,CaO,Na2O,K2O,
Li,Sc,Ti,V,Cr,Co,Ni,Cu,Zn,As,Rb,Sr,Y,Zr,Nb,Cd,Cs,Ba,La,Ce,Pr,Nd,
Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,Pb,Th,U,K,
Sr87_Sr86,Nd143_Nd144,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204)
q12 <- dbGetQuery(pofatu,
"SELECT s.id AS sample_id, s.sample_category, s.location_region,
s.location_subregion, s.location_latitude, s.location_longitude,
max(CASE WHEN m.parameter='SiO2 [%]' then m.value END) AS 'SiO2 [%]',
max(CASE WHEN m.parameter='TiO2 [%]' then m.value END) AS 'TiO2 [%]',
max(CASE WHEN m.parameter='Al2O3 [%]' then m.value END) AS 'Al2O3 [%]',
max(CASE WHEN m.parameter='Fe2O3 [%]' then m.value END) AS 'Fe2O3 [%]',
max(CASE WHEN m.parameter='FeO [%]' then m.value END) AS 'FeO [%]',
max(CASE WHEN m.parameter='MnO [%]' then m.value END) AS 'MnO [%]',
max(CASE WHEN m.parameter='MgO [%]' then m.value END) AS 'MgO [%]',
max(CASE WHEN m.parameter='CaO [%]' then m.value END) AS 'CaO [%]',
max(CASE WHEN m.parameter='Na2O [%]' then m.value END) AS 'Na2O [%]',
max(CASE WHEN m.parameter='K2O [%]' then m.value END) AS 'K2O [%]',
max(CASE WHEN m.parameter='Li [ppm]' then m.value END) AS 'Li [ppm]',
max(CASE WHEN m.parameter='Sc [ppm]' then m.value END) AS 'Sc [ppm]',
max(CASE WHEN m.parameter='Ti [ppm]' then m.value END) AS 'Ti [ppm]',
max(CASE WHEN m.parameter='V [ppm]' then m.value END) AS 'V [ppm]',
max(CASE WHEN m.parameter='Cr [ppm]' then m.value END) AS 'Cr [ppm]',
max(CASE WHEN m.parameter='Co [ppm]' then m.value END) AS 'Co [ppm]',
max(CASE WHEN m.parameter='Ni [ppm]' then m.value END) AS 'Ni [ppm]',
max(CASE WHEN m.parameter='Cu [ppm]' then m.value END) AS 'Cu [ppm]',
max(CASE WHEN m.parameter='Zn [ppm]' then m.value END) AS 'Zn [ppm]',
max(CASE WHEN m.parameter='As [ppm]' then m.value END) AS 'As [ppm]',
max(CASE WHEN m.parameter='Rb [ppm]' then m.value END) AS 'Rb [ppm]',
max(CASE WHEN m.parameter='Sr [ppm]' then m.value END) AS 'Sr [ppm]',
max(CASE WHEN m.parameter='Y [ppm]' then m.value END) AS 'Y [ppm]',
max(CASE WHEN m.parameter='Zr [ppm]' then m.value END) AS 'Zr [ppm]',
max(CASE WHEN m.parameter='Nb [ppm]' then m.value END) AS 'Nb [ppm]',
max(CASE WHEN m.parameter='Cd [ppm]' then m.value END) AS 'Cd [ppm]',
max(CASE WHEN m.parameter='Cs [ppm]' then m.value END) AS 'Cs [ppm]',
max(CASE WHEN m.parameter='Ba [ppm]' then m.value END) AS 'Ba [ppm]',
max(CASE WHEN m.parameter='La [ppm]' then m.value END) AS 'La [ppm]',
max(CASE WHEN m.parameter='Ce [ppm]' then m.value END) AS 'Ce [ppm]',
max(CASE WHEN m.parameter='Pr [ppm]' then m.value END) AS 'Pr [ppm]',
max(CASE WHEN m.parameter='Nd [ppm]' then m.value END) AS 'Nd [ppm]',
max(CASE WHEN m.parameter='Sm [ppm]' then m.value END) AS 'Sm [ppm]',
max(CASE WHEN m.parameter='Eu [ppm]' then m.value END) AS 'Eu [ppm]',
max(CASE WHEN m.parameter='Gd [ppm]' then m.value END) AS 'Gd [ppm]',
max(CASE WHEN m.parameter='Tb [ppm]' then m.value END) AS 'Tb [ppm]',
max(CASE WHEN m.parameter='Dy [ppm]' then m.value END) AS 'Dy [ppm]',
max(CASE WHEN m.parameter='Ho [ppm]' then m.value END) AS 'Ho [ppm]',
max(CASE WHEN m.parameter='Er [ppm]' then m.value END) AS 'Er [ppm]',
max(CASE WHEN m.parameter='Tm [ppm]' then m.value END) AS 'Tm [ppm]',
max(CASE WHEN m.parameter='Yb [ppm]' then m.value END) AS 'Yb [ppm]',
max(CASE WHEN m.parameter='Lu [ppm]' then m.value END) AS 'Lu [ppm]',
max(CASE WHEN m.parameter='Hf [ppm]' then m.value END) AS 'Hf [ppm]',
max(CASE WHEN m.parameter='Ta [ppm]' then m.value END) AS 'Ta [ppm]',
max(CASE WHEN m.parameter='Tl [ppm]' then m.value END) AS 'Tl [ppm]',
max(CASE WHEN m.parameter='Pb [ppm]' then m.value END) AS 'Pb [ppm]',
max(CASE WHEN m.parameter='Th [ppm]' then m.value END) AS 'Th [ppm]',
max(CASE WHEN m.parameter='U [ppm]' then m.value END) AS 'U [ppm]',
max(CASE WHEN m.parameter='Nd143_Nd144' then m.value END) AS 'Nd143_Nd144',
max(CASE WHEN m.parameter='Sr87_Sr86' then m.value END) AS 'Sr87_Sr86',
max(CASE WHEN m.parameter='Pb206_Pb204' then m.value END) AS 'Pb206_Pb204',
max(CASE WHEN m.parameter='Pb207_Pb204' then m.value END) AS 'Pb207_Pb204',
max(CASE WHEN m.parameter='Pb208_Pb204' then m.value END) AS 'Pb208_Pb204'
FROM 'samples.csv' AS s JOIN 'measurements.csv' AS m ON s.id=m.sample_id
WHERE s.sample_category = 'SOURCE' AND
m.parameter IN ('SiO2 [%]', 'TiO2 [%]', 'Al2O3 [%]', 'Fe2O3 [%]', 'FeO [%]',
'MnO [%]', 'MgO [%]', 'CaO [%]', 'Na2O [%]', 'K2O [%]',
'Li [ppm]', 'Sc [ppm]', 'Ti [ppm]', 'V [ppm]',
'Cr [ppm]', 'Co [ppm]', 'Ni [ppm]', 'Cu [ppm]', 'Zn [ppm]', 'As [ppm]',
'Rb [ppm]', 'Sr [ppm]', 'Y [ppm]', 'Zr [ppm]', 'Nb [ppm]', 'Cd [ppm]',
'Cs [ppm]', 'Ba [ppm]', 'La [ppm]', 'Ce [ppm]', 'Pr [ppm]', 'Nd [ppm]',
'Sm [ppm]', 'Eu [ppm]', 'Gd [ppm]', 'Tb [ppm]', 'Dy [ppm]', 'Ho [ppm]',
'Er [ppm]', 'Tm [ppm]', 'Yb [ppm]', 'Lu [ppm]', 'Hf [ppm]', 'Ta [ppm]',
'Tl [ppm]', 'Pb [ppm]', 'Th [ppm]', 'U [ppm]', 'Nd143_Nd144', 'Sr87_Sr86',
'Pb206_Pb204', 'Pb207_Pb204', 'Pb208_Pb204') GROUP BY sample_id") %>%
rename_pofatu_elements() %>% pofatu_location() %>%
dplyr::filter(Location %in% c(
"Caroline islands","Samoan islands","Austral-Cook chain","Society islands",
"Hawai'i islands","Marquesas islands","Pitcairn-Gambier chain","Rapa Nui")) %>%
Ti_from_TiO2() %>% K_from_K2O() %>% dplyr::select(
Sample,Location,lat,long,SiO2,TiO2,Al2O3,MnO,MgO,CaO,Na2O,K2O,
Li,Sc,Ti,V,Cr,Co,Ni,Cu,Zn,As,Rb,Sr,Y,Zr,Nb,Cd,Cs,Ba,La,Ce,Pr,Nd,
Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,Pb,Th,U,K,
Sr87_Sr86,Nd143_Nd144,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204) %>%
dplyr::filter((SiO2 > 45.2 & SiO2 < 48.2 &
Na2O > 2.08 & Na2O < 5.08 &
K2O > 0 & K2O < 2.9 &
Rb > 18.3 & Rb < 54.9 &
Ba > 160 & Ba < 480 &
Th > 1.95 & Th < 5.84 &
Sr > 352 & Sr < 1056 &
Nb > 24.8 & Nb < 74.5) |
(SiO2 > 44.3 & SiO2 < 47.3 &
Na2O > 2 & Na2O < 5 &
K2O > 0 & K2O < 2.82 &
Rb > 16.8 & Rb < 50.4 &
Ba > 137 & Ba < 413 &
Th > 1.86 & Th < 5.60 &
Sr > 332 & Sr < 996 &
Nb > 24.7 & Nb < 74.1) |
(SiO2 > 43.5 & SiO2 < 46.5 &
Na2O > 1.9 & Na2O < 4.9 &
K2O > 0 & K2O < 2.78 &
Rb > 15.3 & Rb < 46.05 &
Ba > 126 & Ba < 378 &
Th > 1.58 & Th < 4.74 &
Sr > 294 & Sr < 882 &
Nb > 21 & Nb < 63.1) |
(SiO2 > 45.9 & SiO2 < 48.9 &
Na2O > 2.18 & Na2O < 5.18 &
K2O > 0 & K2O < 2.99 &
Rb > 20.55 & Rb < 61.65 &
Ba > 162 & Ba < 488 &
Th > 2.13 & Th < 6.39 &
Sr > 365 & Sr < 1095 &
Nb > 24.3 & Nb < 72.9) |
(SiO2 > 44.1 & SiO2 < 47.1 &
Na2O > 1.8 & Na2O < 4.8 &
K2O > 0 & K2O < 2.72 &
Rb > 15.6 & Rb < 47 &
Ba > 128 & Ba < 385 &
Th > 1.58 & Th < 4.74 &
Sr > 296 & Sr < 890 &
Nb > 20.4 & Nb < 61.2) |
(SiO2 > 45.7 & SiO2 < 48.7 &
Na2O > 2.08 & Na2O < 5.08 &
K2O > 0 & K2O < 2.85 &
Rb > 18.2 & Rb < 54.6 &
Ba > 143 & Ba < 431 &
Th > 1.84 & Th < 5.52 &
Sr > 370 & Sr < 1110 &
Nb > 23.5 & Nb < 70.5) |
(SiO2 > 37 & SiO2 < 40 &
Na2O > 1.61 & Na2O < 4.61 &
K2O > 0 & K2O < 2.91 &
Rb > 12.2 & Rb < 36.8 &
Ba > 244 & Ba < 734 &
Th > 2.73 & Th < 8.2 &
Sr > 452 & Sr < 1358 &
Nb > 46.4 & Nb < 139.3) |
(SiO2 > 43.1 & SiO2 < 46.1 &
Na2O > 0.89 & Na2O < 3.89 &
K2O > 0 & K2O < 1.89 &
Rb > 2.77 & Rb < 8.32 &
Ba > 59 & Ba < 177 &
Th > 0.56 & Th < 1.67 &
Sr > 191 & Sr < 573 &
Nb > 6.45 & Nb < 19.35) |
(SiO2 > 42.9 & SiO2 < 45.9 &
Na2O > 2.41 & Na2O < 5.41 &
K2O > 0 & K2O < 2.35 &
Rb > 1.21 & Rb < 3.64 &
Ba > 15.75 & Ba < 47.3 &
Th > 1.02 & Th < 3.06 &
Sr > 331 & Sr < 995 &
Nb > 22.2 & Nb < 66.6))
#### Fig 4b ####
## Emae_Taumako PCA 2
OIB <- full_join(q11,q12)
OIB %>% group_by(Location) %>% tally() %>% print(n=30)
library(scales)
library(pals)
show_col(plasma(9))
show_col(inferno(13))
show_col(inferno(6))
show_col(plasma(6))
print_col(cubicl(6))
show_col(cubicl(6))
show_col(viridis(6))
show_col(magma(6))
show_col(magma(13))
show_col(magma(13))
show_col(inferno(13))
show_col(inferno(16))
OIB %>% group_by(Location) %>% tally()
OIB %>% group_by(Location) %>% tally()
#### Fig 4b ####
## Emae_Taumako PCA 2
OIB <- full_join(q11,q12) %>% dplyr::select(
Sample,Location,TiO2,Al2O3,MgO,CaO,Na2O,Rb,Ba,Th,Nb,Ce,Nd,Sr,Sm,Zr,Yb)
View(OIB)
res.pca <- prcomp(IAB[,3:17],  scale = TRUE, center = TRUE) # Dimension reduction using PCA
res.pca <- prcomp(OIB[,3:17],  scale = TRUE, center = TRUE) # Dimension reduction using PCA
res.pca <- prcomp(OIB[,3:17],  scale = TRUE, center = TRUE) # Dimension reduction using PCA
s <- joined_data %>% filter(Sample %in% c(
"E-11-08","E-11-08dup","T-12-06","T-12-06dup","T-12-07","T-12-08",
"T-12-09","T-12-10")) %>% mutate(Location = case_when(
grepl("E-11-08", Sample) ~ "E-11-08",
grepl("E-11-08dup", Sample) ~ "E-11-08dup",
grepl("T-12-06", Sample) ~ "T-12-06",
grepl("T-12-06dup", Sample) ~ "T-12-06dup",
grepl("T-12-07", Sample) ~ "T-12-07",
grepl("T-12-08", Sample) ~ "T-12-08",
grepl("T-12-09", Sample) ~ "T-12-09",
grepl("T-12-10", Sample) ~ "T-12-10")) %>% dplyr::select(
Sample,Location,TiO2,Al2O3,MgO,CaO,Na2O,Rb,Ba,Th,Nb,Ce,Nd,Sr,Sm,Zr,Yb)
s[s == 0] <- NA # Replace 0 with NA
s <- s[rowSums(is.na(s)) == 0,] # removes rows with missing info for PCA
#### Fig 4b ####
## Emae_Taumako PCA 2
OIB <- full_join(q11,q12) %>% dplyr::select(
Sample,Location,TiO2,Al2O3,MgO,CaO,Na2O,Rb,Ba,Th,Nb,Ce,Nd,Sr,Sm,Zr,Yb)
is.na(OIB) <- sapply(OIB, is.infinite) #replace Inf by NA
OIB[OIB == 0] <- NA # Replace 0 with NA
OIB <- OIB[rowSums(is.na(OIB)) == 0,] # removes rows with missing info for PCA
res.pca <- prcomp(IAB[,3:17], scale = TRUE, center = TRUE) # Dimension reduction using PCA
res.pca <- prcomp(OIB[,3:17], scale = TRUE, center = TRUE) # Dimension reduction using PCA
eig <- get_eig(res.pca)
E_T_PCA_2a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = IAB$Location, fill.ind = IAB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
#scale_x_continuous(limits=c(-4, 4), breaks = c(-4,-2,0,2,4)) +
#scale_y_continuous(limits=c(-5, 5), breaks = c(-4,-2,0,2,4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 10), axis.text = element_text(size = 10),
legend.title = element_blank(), legend.text = element_text(size = 10),
legend.key.size = unit(.2, 'cm'), legend.position = "none", aspect.ratio=1)
E_11_03_PCA_2a
pdf(here("analysis","figures","Figure_4","Fig4-b-PCA.pdf"), width=3.5, height=3.5)
E_11_03_PCA_2a
dev.off()
pdf(here("analysis","figures","Figure_4","Fig4-b-PCA.pdf"), width=3.5, height=3.5)
E_T_PCA_2a
dev.off()
E_T_PCA_2a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = IAB$Location, fill.ind = IAB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
#scale_x_continuous(limits=c(-4, 4), breaks = c(-4,-2,0,2,4)) +
#scale_y_continuous(limits=c(-5, 5), breaks = c(-4,-2,0,2,4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 10), axis.text = element_text(size = 10),
legend.title = element_blank(), legend.text = element_text(size = 10),
legend.key.size = unit(.2, 'cm'), legend.position = "none", aspect.ratio=1)
E_T_PCA_2a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = IAB$Location, fill.ind = OIB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
#scale_x_continuous(limits=c(-4, 4), breaks = c(-4,-2,0,2,4)) +
#scale_y_continuous(limits=c(-5, 5), breaks = c(-4,-2,0,2,4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 10), axis.text = element_text(size = 10),
legend.title = element_blank(), legend.text = element_text(size = 10),
legend.key.size = unit(.2, 'cm'), legend.position = "none", aspect.ratio=1)
E_T_PCA_2a
pdf(here("analysis","figures","Figure_4","Fig4-b-PCA.pdf"), width=3.5, height=3.5)
E_T_PCA_2a
dev.off()
E_T_PCA_2a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = IAB$Location, fill.ind = OIB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
#scale_x_continuous(limits=c(-4, 4), breaks = c(-4,-2,0,2,4)) +
#scale_y_continuous(limits=c(-5, 5), breaks = c(-4,-2,0,2,4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 10), axis.text = element_text(size = 10),
legend.title = element_blank(), legend.text = element_text(size = 10),
legend.key.size = unit(.2, 'cm'), legend.position = "none", aspect.ratio=1)
E_T_PCA_2a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = OIB$Location, fill.ind = OIB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
#scale_x_continuous(limits=c(-4, 4), breaks = c(-4,-2,0,2,4)) +
#scale_y_continuous(limits=c(-5, 5), breaks = c(-4,-2,0,2,4)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=1),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 10), axis.text = element_text(size = 10),
legend.title = element_blank(), legend.text = element_text(size = 10),
legend.key.size = unit(.2, 'cm'), legend.position = "none", aspect.ratio=1)
E_T_PCA_2a
pdf(here("analysis","figures","Figure_4","Fig4-b-PCA.pdf"), width=3.5, height=3.5)
E_T_PCA_2a
dev.off()
joined_data_ranges[4,2:35]
joined_data_ranges[11:15,2:35]
joined_data_ranges[11:15,33:35]
joined_data_ranges[11:15,32:33]
joined_data_ranges[11:15,32:33] %>% round(digits = 2)
joined_data_ranges[4,2:35]
joined_data_ranges[11:15,32:33] %>% round(digits = 2)
joined_data_ranges[11:15,2:35]
joined_data_ranges[4,2:35]
joined_data_ranges[11:15,32:33] %>% round(digits = 2)

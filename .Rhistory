`Ba min` = (Ba-((Ba*50)/100)), `Ba max` = (Ba+((Ba*50)/100)), # +/- 50%
`Th min` = (Th-((Th*50)/100)), `Th max` = (Th+((Th*50)/100)), # +/- 50%
`Ce min` = (Ce-((Ce*50)/100)), `Ce max` = (Ce+((Ce*50)/100)), # +/- 50%
`Pb min` = (Pb-((Pb*50)/100)), `Pb max` = (Pb+((Pb*50)/100)), # +/- 50%
`Nd min` = (Nd-((Nd*50)/100)), `Nd max` = (Nd+((Nd*50)/100)), # +/- 50%
`Sr min` = (Sr-((Sr*50)/100)), `Sr max` = (Sr+((Sr*50)/100)), # +/- 50%
`Nb min` = (Nb-((Nb*50)/100)), `Nb max` = (Nb+((Nb*50)/100)), # +/- 50%
`Sm min` = (Sm-((Sm*50)/100)), `Sm max` = (Sm+((Sm*50)/100)), # +/- 50%
`Zr min` = (Zr-((Zr*50)/100)), `Zr max` = (Zr+((Zr*50)/100)), # +/- 50%
`Yb min` = (Yb-((Yb*50)/100)), `Yb max` = (Yb+((Yb*50)/100)), # +/- 50%
`Ti min` = (Ti-((Ti*50)/100)), `Ti max` = (Ti+((Ti*50)/100)), # +/- 50%
`Nd143_Nd144 min` = (Nd143_Nd144-((Nd143_Nd144*1)/1000)), # 1‰
`Nd143_Nd144 max` = (Nd143_Nd144+((Nd143_Nd144*1)/1000)), # 1‰
`Sr87_Sr86 min` = (Sr87_Sr86-((Sr87_Sr86*1)/1000)), # 1‰
`Sr87_Sr86 max` = (Sr87_Sr86+((Sr87_Sr86*1)/1000)), # 1‰
`Pb206_Pb204 min` = (Pb206_Pb204-((Pb206_Pb204*1)/100)), # 1%
`Pb206_Pb204 max` = (Pb206_Pb204+((Pb206_Pb204*1)/100)), # 1%
`Pb207_Pb204 min` = (Pb207_Pb204-((Pb207_Pb204*1)/100)), # 1%
`Pb207_Pb204 max` = (Pb207_Pb204+((Pb207_Pb204*1)/100)), # 1%
`Pb208_Pb204 min` = (Pb208_Pb204-((Pb208_Pb204*1)/100)), # 1%
`Pb208_Pb204 max` = (Pb208_Pb204+((Pb208_Pb204*1)/100))  # 1%
)
return(df_ranges)
}
ranges_s_IAB <- joined_data %>% dplyr::filter(Sample %in% c(
"E-11-03","E-11-06","E-11-07","K-12-28","K-12-29")) %>% ranges_IAB()
write_csv(ranges_s_IAB, (here(
"analysis", "data", "derived_data","IAB_ranges.csv")))
ranges_s_OIB <- joined_data %>% dplyr::filter(Sample %in% c(
"E-11-08","T-12-06","T-12-07","T-12-08","T-12-09","T-12-10",
"K-12-24","K-12-25","K-12-26")) %>% ranges_OIB()
write_csv(ranges_s_OIB, (here(
"analysis", "data", "derived_data","OIB_ranges.csv")))
## normalizes trace element values to primitive mantle,
## based on PM values from McDonough & Sun (1989,1995)
sun <- read.csv(here(
"analysis", "data", "raw_data", "sun_mcdonough.csv"),
header=TRUE, sep=",", stringsAsFactors=FALSE)
normalize_to_pm <- function(df) {
df_normalized <- df %>%
dplyr::mutate(
Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],Th=Th/sun[2,"Th"],
U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
return(df_normalized)
}
joined_data_norm <- normalize_to_pm(joined_data)
## georoc_location_from_file_id()
get_georoc_location <- function(georoc_output) {
georoc_output_with_location <- georoc_output %>%
mutate(
Location = case_when(
grepl("BANDA_ARC", file_id) ~ "Banda Arc",
grepl("BISMARCK_ARC", file_id) ~ "Bismarck Arc",
grepl("LUZON_ARC", file_id) ~ "Luzon Arc",
grepl("MARIANA_ARC", file_id) ~ "Mariana Arc",
grepl("NEW_CALEDONIA", file_id) ~ "New Caledonia",
grepl("NEW_HEBRIDES_ARC", file_id) ~ "Vanuatu Arc",
grepl("NEW_ZEALAND", file_id) ~ "New Zealand",
grepl("SOLOMON_ISLAND_ARC", file_id) ~ "Solomon Arc",
grepl("SULAWESI_ARC", file_id) ~ "Sulawesi Arc",
grepl("SUNDA_ARC", file_id) ~ "Sunda Arc",
grepl("TONGA_ARC", file_id) ~ "Tonga-Fiji",
LOCATION == "TONGA ARC / WALLIS-FUTUNA ISLANDS / WALLIS (UVEA) ISLANDS" ~ "Uvea (Wallis)",
grepl("YAP_ARC", file_id) ~ "Yap Arc",
grepl("AUSTRAL-COOK_ISLANDS", file_id) & long > -155 ~ "Austral-Cook chain",
grepl("AUSTRAL-COOK_ISLANDS", file_id) & long < -155 ~ "Austral-Cook chain",
grepl("CAROLINE_ISLANDS", file_id) ~ "Caroline islands",
grepl("EASTER_SEAMOUNT_CHAIN", file_id) ~ "Rapa Nui",
grepl("HAWAIIAN_ISLANDS", file_id) ~ "Hawai'i islands",
grepl("MARQUESAS", file_id) ~ "Marquesas islands",
grepl("PITCAIRN-GAMBIER", file_id) & long > -132 ~ "Pitcairn-Gambier chain",
grepl("PITCAIRN-GAMBIER", file_id) & long < -132 ~ "Pitcairn-Gambier chain",
grepl("SAMOAN_ISLANDS", file_id) ~ "Samoan islands",
grepl("SOCIETY_ISLANDS", file_id) ~ "Society islands",
grepl("TUAMOTU_ISLANDS", file_id) ~ "Tuamotu islands",
TRUE ~ "na"))
return(georoc_output_with_location)
}
## pofatu_location()
pofatu_location <- function(pofatu_output) {
pofatu_output_with_location <- pofatu_output %>%
mutate(
Location = case_when(
location_region == "AUSTRAL" ~ "Austral-Cook chain",
location_region == "CAROLINE" ~ "Caroline islands",
location_region == "COOK ISLANDS" ~ "Austral-Cook chain",
location_region == "FIJI" ~ "Tonga Arc",
location_region == "FIJI/LAU_GROUP" ~ "Tonga Arc",
location_region == "GAMBIER" ~ "Pitcairn-Gambier chain",
location_region == "HAWAI'I" ~ "Hawai'i islands",
location_region == "HENDERSON" ~ "Pitcairn-Gambier chain",
location_region == "MARQUESAS" ~ "Marquesas islands",
location_region == "NEW GUINEA" ~ "New Guinea",
location_region == "NEW ZEALAND" ~ "New Zealand",
location_region == "PITCAIRN" ~ "Pitcairn-Gambier chain",
location_region == "RAPA NUI" ~ "Rapa Nui",
location_region == "ROTUMA" ~ "Tonga Arc",
location_region == "SAMOA" ~ "Samoan islands",
location_region == "SOCIETY" ~ "Society islands",
location_region == "SOLOMON" ~ "Solomon Arc",
location_region == "SOLOMON/STA_CRUZ_GROUP" ~ "Solomon Arc",
location_region == "TIMOR" ~ "Timor",
location_region == "TOKELAU" ~ "Tokelau islands",
location_region == "TONGA" ~ "Tonga Arc",
location_region == "TUAMOTU" ~ "Tuamotu islands",
location_region == "TUVALU" ~ "Tuvalu islands",
location_region == "UVEA" ~ "Uvea island",
location_region == "VANUATU" ~ "Vanuatu Arc",
TRUE ~ "na"))
return(pofatu_output_with_location)
}
View(joined_data_norm)
normalize_to_pm <- function(df) {
df_normalized <- df %>%
dplyr::mutate(
Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],Th=Th/sun[2,"Th"],
U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
return(df_normalized)
}
joined_data_norm <- normalize_to_pm(joined_data)
View(sunmcdonough)
spider <- joined_data_norm %>% gather("var","conc",Cs:Lu)
df_normalized <- df %>%
dplyr::transmute(
Sample=Sample, Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],
Th=Th/sun[2,"Th"],U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
normalize_to_pm <- function(df) {
df_normalized <- df %>%
dplyr::transmute(
Sample=Sample, Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],
Th=Th/sun[2,"Th"],U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
return(df_normalized)
}
normalize_to_pm <- function(df) {
df_normalized <- df %>%
dplyr::transmute(
Sample=Sample, Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],
Th=Th/sun[2,"Th"],U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
return(df_normalized)
}
joined_data_norm <- normalize_to_pm(joined_data)
View(joined_data_norm)
## Figure S9
# load primitive mantle and average values for OIB and IAB from Sun & McDonough (1989) & Niu & O'hara (2003)
sunmcdonough <- read.csv(here("analysis", "data", "raw_data", "sun_mcdonough.csv"),
header=TRUE, sep=",", stringsAsFactors=FALSE)
# tidy and normalize datasets
oib <- sunmcdonough %>% dplyr::filter(Sample=="OIB") %>% normalize_to_pm()
iab <- sunmcdonough %>% dplyr::filter(Sample=="IAB") %>% normalize_to_pm()
# wide to long format
oib <- gather(oib,"var","conc",Cs:Lu)
View(joined_data_norm)
shapes <- c("E-11-03"=0,"E-11-06"=1,"E-11-07"=8,"E-11-10"=0,"E-11-11"=1,
"E-11-13"=2,"E-11-16"=5,"E-11-18"=6,"E-11-19"=8,"K-12-28"=3,"K-12-29"=4,
"E-11-08"=5,"E-11-08dup"=9,"T-12-06"=2,"T-12-06dup"=14,
"T-12-07"=7,"T-12-08"=6,"T-12-09"=10,"T-12-10"=11,"K-12-24"=12,
"K-12-25"=13,"K-12-26"=14,"OIB"=21,"IAB"=23)
cols <- c("E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red",
"E-11-08"="red","E-11-08dup"="red","T-12-06"="red","T-12-06dup"="red",
"T-12-07"="red","T-12-08"="red","T-12-09"="red",
"T-12-10"="red","K-12-24"="red","K-12-25"="red","K-12-26"="red",
"OIB"="yellow","IAB"="blue")
contour <- c("E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red",
"E-11-08"="red","E-11-08dup"="red","T-12-06"="red","T-12-06dup"="red",
"T-12-07"="red","T-12-08"="red","T-12-09"="red",
"T-12-10"="red","K-12-24"="red","K-12-25"="red","K-12-26"="red",
"OIB"="black","IAB"="black")
p1 <- spider %>%
filter(Sample %in% c(
"E-11-10", "E-11-11", "E-11-13", "E-11-16", "E-11-18", "E-11-19")) %>%
mutate(var = fct_relevel(
var, "Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="A", fontface="bold")
p1 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-10", "E-11-11", "E-11-13", "E-11-16", "E-11-18", "E-11-19")) %>%
dplyr::mutate(var = fct_relevel(
var, "Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="A", fontface="bold")
normalize_to_pm <- function(df) {
df_normalized <- df %>%
dplyr::transmute(
Sample=Sample, Cs=Cs/sun[2,"Cs"],Rb=Rb/sun[2,"Rb"],Ba=Ba/sun[2,"Ba"],
Th=Th/sun[2,"Th"],U=U/sun[2,"U"],Nb=Nb/sun[2,"Nb"],Ta=Ta/sun[2,"Ta"],La=La/sun[2,"La"],
Ce=Ce/sun[2,"Ce"],Pr=Pr/sun[2,"Pr"],Pb=Pb/sun[2,"Pb"],Nd=Nd/sun[2,"Nd"],Sr=Sr/sun[2,"Sr"],
Sm=Sm/sun[2,"Sm"],Zr=Zr/sun[2,"Zr"],Hf=Hf/sun[2,"Hf"],Ti=Ti/sun[2,"Ti"],Eu=Eu/sun[2,"Eu"],
Gd=Gd/sun[2,"Gd"],Tb=Tb/sun[2,"Tb"],Dy=Dy/sun[2,"Dy"],Ho=Ho/sun[2,"Ho"],Y=Y/sun[2,"Y"],
Er=Er/sun[2,"Er"],Li=Li/sun[2,"Li"],Yb=Yb/sun[2,"Yb"],Lu=Lu/sun[2,"Lu"]) %>%
gather("var","conc",Cs:Lu)
return(df_normalized)
}
joined_data_norm <- normalize_to_pm(joined_data)
View(joined_data_norm)
## Figure S9
# load primitive mantle and average values for OIB and IAB from Sun & McDonough (1989) & Niu & O'hara (2003)
sunmcdonough <- read.csv(here("analysis", "data", "raw_data", "sun_mcdonough.csv"),
header=TRUE, sep=",", stringsAsFactors=FALSE)
# tidy and normalize datasets
oib <- sunmcdonough %>% dplyr::filter(Sample=="OIB") %>% normalize_to_pm()
iab <- sunmcdonough %>% dplyr::filter(Sample=="IAB") %>% normalize_to_pm()
shapes <- c("E-11-03"=0,"E-11-06"=1,"E-11-07"=8,"E-11-10"=0,"E-11-11"=1,
"E-11-13"=2,"E-11-16"=5,"E-11-18"=6,"E-11-19"=8,"K-12-28"=3,"K-12-29"=4,
"E-11-08"=5,"E-11-08dup"=9,"T-12-06"=2,"T-12-06dup"=14,
"T-12-07"=7,"T-12-08"=6,"T-12-09"=10,"T-12-10"=11,"K-12-24"=12,
"K-12-25"=13,"K-12-26"=14,"OIB"=21,"IAB"=23)
cols <- c("E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red",
"E-11-08"="red","E-11-08dup"="red","T-12-06"="red","T-12-06dup"="red",
"T-12-07"="red","T-12-08"="red","T-12-09"="red",
"T-12-10"="red","K-12-24"="red","K-12-25"="red","K-12-26"="red",
"OIB"="yellow","IAB"="blue")
contour <- c("E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red",
"E-11-08"="red","E-11-08dup"="red","T-12-06"="red","T-12-06dup"="red",
"T-12-07"="red","T-12-08"="red","T-12-09"="red",
"T-12-10"="red","K-12-24"="red","K-12-25"="red","K-12-26"="red",
"OIB"="black","IAB"="black")
p1 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-10", "E-11-11", "E-11-13", "E-11-16", "E-11-18", "E-11-19")) %>%
dplyr::mutate(var = fct_relevel(
var, "Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="A", fontface="bold")
p1
p2 <- spider %>%
dplyr::filter(Sample %in% c("E-11-03", "E-11-06", "E-11-07", "K-12-28", "K-12-29")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="B", fontface="bold")
p3 <- spider %>%
dplyr::filter(Sample %in% c(
"E-11-08","K-12-24","K-12-25","K-12-26","T-12-06","T-12-06dup",
"T-12-07","T-12-08","T-12-09","T-12-10")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=oib) + geom_point(data=oib, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="C", fontface="bold")
S9 <- p1/p2/p3
S9
p2 <- spider %>%
dplyr::filter(Sample %in% c("E-11-03", "E-11-06", "E-11-07", "K-12-28", "K-12-29")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="B", fontface="bold")
p1 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-10", "E-11-11", "E-11-13", "E-11-16", "E-11-18", "E-11-19")) %>%
dplyr::mutate(var = fct_relevel(
var, "Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="A", fontface="bold")
p2 <- joined_data_norm %>%
dplyr::filter(Sample %in% c("E-11-03", "E-11-06", "E-11-07", "K-12-28", "K-12-29")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="B", fontface="bold")
p3 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-08","K-12-24","K-12-25","K-12-26","T-12-06","T-12-06dup",
"T-12-07","T-12-08","T-12-09","T-12-10")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=oib) + geom_point(data=oib, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="C", fontface="bold")
S9 <- p1/p2/p3
S9
pdf(here("analysis","supplementary-materials","FigS9.pdf"), width=8, height=8)
S9
dev.off()
p1 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-10", "E-11-11", "E-11-13", "E-11-16", "E-11-18", "E-11-19")) %>%
dplyr::mutate(var = fct_relevel(
var, "Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_blank(),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="A", fontface="bold")
p2 <- joined_data_norm %>%
dplyr::filter(Sample %in% c("E-11-03", "E-11-06", "E-11-07", "K-12-28", "K-12-29")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=iab) + geom_point(data=iab, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=9),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="B", fontface="bold")
p3 <- joined_data_norm %>%
dplyr::filter(Sample %in% c(
"E-11-08","K-12-24","K-12-25","K-12-26","T-12-06","T-12-06dup",
"T-12-07","T-12-08","T-12-09","T-12-10")) %>%
dplyr::mutate(var = fct_relevel(
var,"Cs","Rb","Ba","Th","U","Nb","Ta","La","Ce","Pr","Pb","Nd","Sr","Sm",
"Zr","Hf","Ti","Eu","Gd","Tb","Dy","Ho","Y","Er","Li","Yb","Lu")) %>%
ggplot(aes(x=var, y=conc, color=factor(Sample), shape=factor(Sample),
fill=factor(Sample), group=Sample)) +
geom_line() + geom_point(size=3) +
geom_line(data=oib) + geom_point(data=oib, size=3) +
scale_shape_manual(values = shapes) +
scale_fill_manual(values = cols) +
scale_color_manual(values = contour) +
scale_y_log10(breaks=c(1,10,100), limits=c(.1,200), labels = scales::comma) +
ylab("Sample / Primitive mantle") + annotation_logticks(sides="l") +
theme(panel.border=element_rect(fill=NA,size=.8),panel.background=element_blank(),
panel.grid.major=element_blank(),panel.grid.minor=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_blank(),
axis.text=element_text(size=9),axis.ticks.y=element_blank(),
legend.title=element_blank(),legend.text=element_text(size=9),
legend.position = "none") +
annotate("text", x=27, y=140, size=6, label="C", fontface="bold")
S9 <- p1/p2/p3
S9
pdf(here("analysis","supplementary-materials","FigS9.pdf"), width=8, height=8)
S9
dev.off()

shapes <- c("Luzon Arc"=21,"Sulawesi Arc"=22,"Sunda Arc"=23,"Banda Arc"=24,
"Yap Arc"=25,"Mariana Arc"=21,"Bismarck Arc"=22,"Solomon Arc"=23,
"Vanuatu Arc"=24,"Tonga-Fiji"=25,"New Zealand"=21,
"E-11-03"=0,"E-11-06"=1,"E-11-07"=8,"E-11-10"=0,"E-11-11"=1,
"E-11-13"=2,"E-11-16"=5,"E-11-18"=6,"E-11-19"=8,"K-12-28"=3,"K-12-29"=4)
cols <- c("Luzon Arc"="#440154","Sulawesi Arc"="#345E8C","Sunda Arc"="#404386",
"Banda Arc"="#472374","Yap Arc"="#29778E","Mariana Arc"="#218F8B",
"Bismarck Arc"="#25A782","Solomon Arc"="#44BE6F","Vanuatu Arc"="#7AD04F",
"Tonga-Fiji"="#BADD26","New Zealand"="#FDE725",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
contour <- c("Luzon Arc"="black","Sulawesi Arc"="black","Sunda Arc"="black",
"Banda Arc"="black","Yap Arc"="black","Mariana Arc"="black",
"Bismarck Arc"="black","Solomon Arc"="black","Vanuatu Arc"="black",
"Tonga-Fiji"="black","New Zealand"="black",
"E-11-03"="red","E-11-06"="red","E-11-07"="red","E-11-10"="#7AD04F",
"E-11-11"="#7AD04F","E-11-13"="#7AD04F","E-11-16"="#7AD04F",
"E-11-18"="#7AD04F","E-11-19"="#7AD04F","K-12-28"="red","K-12-29"="red")
dir.create(here("analysis","supplementary-materials","FigS10"))
#### Fig S10a ####
## E_11_03 PCA1
q1 <- q1 %>% dplyr::select(
Sample,Location,Sr87_Sr86,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204,Nd143_Nd144)
s <- joined_data %>% filter(Sample %in% c(
"E-11-10","E-11-11","E-11-13","E-11-16","E-11-18","E-11-18dup",
"E-11-19","E-11-03")) %>%
mutate(Location = case_when(
grepl("E-11-10", Sample) ~ "Vanuatu Arc",
grepl("E-11-11", Sample) ~ "Vanuatu Arc",
grepl("E-11-13", Sample) ~ "Vanuatu Arc",
grepl("E-11-16", Sample) ~ "Vanuatu Arc",
grepl("E-11-18", Sample) ~ "Vanuatu Arc",
grepl("E-11-18dup", Sample) ~ "Vanuatu Arc",
grepl("E-11-19", Sample) ~ "Vanuatu Arc",
grepl("E-11-03", Sample) ~ "E-11-03"))%>%
dplyr::select(Sample,Location,
Sr87_Sr86,Pb206_Pb204,Pb207_Pb204,Pb208_Pb204,Nd143_Nd144)
IAB <- full_join(q1,s[3:6,])
s <- s[1,]
is.na(IAB) <- sapply(IAB, is.infinite) #replace Inf by NA
IAB[IAB == 0] <- NA # Replace 0 with NA
IAB <- IAB[rowSums(is.na(IAB)) == 0,] # removes rows with missing info for PCA
is.na(s) <- sapply(s, is.infinite) #replace Inf by NA
s[s == 0] <- NA # Replace 0 with NA
s <- s[rowSums(is.na(s)) == 0,] # removes rows with missing info for PCA
res.pca <- prcomp(IAB[,3:7], scale = TRUE, center = TRUE) # Dimension reduction using PCA
eig <- get_eig(res.pca)
E_11_03_PCA_1a <- fviz_pca_biplot(
res.pca, label = "var", col.var = "black", alpha.var = .2,
habillage = IAB$Location, fill.ind = IAB$Location,
pointsize = 2, invisible = "quali", labelsize = 3, repel = T) +
scale_shape_manual(values=shapes) +
scale_fill_manual(values=cols) +
scale_color_manual(values=cols) +
scale_x_continuous(limits=c(-4, 4)) + scale_y_continuous(limits=c(-2,2.5)) +
theme(panel.border = element_rect(colour = "black", fill=NA, size=.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "white"), title = element_blank(),
axis.title = element_text(size = 8), axis.text = element_text(size = 8),
legend.position = "none", aspect.ratio=1)
